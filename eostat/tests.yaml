schemaVersion: "2.0.0"
metadataTest:
  user: 1000
  workdir: "/home/jovyan"
fileExistenceTests:
  - name: "user home"
    path: "/home/jovyan"
    shouldExist: true
  - name: "eostat init script"
    path: "/opt/onyxia-eostat-init.sh"
    shouldExist: true
    permissions: "-rwxr-xr-x"
commandTests:
  - name: "R binary exists"
    command: "which"
    args: ["R"]
    expectedOutput: ["/usr/local/bin/R"]
  - name: "Python binary exists"
    command: "which"
    args: ["python"]
    expectedOutput: ['/opt/python/bin/python']
  - name: "pip binary exists"
    command: "which"
    args: ["pip"]
    expectedOutput: ['/opt/python/bin/pip']
  - name: "JupyterLab binary exists"
    command: "which"
    args: ["jupyter"]
    expectedOutput: ["/opt/python/bin/jupyter"]
  - name: "git-lfs installed"
    command: "git"
    args: ["lfs", "version"]
    exitCode: 0
  - name: "GDAL installed (via rasterio)"
    command: "python"
    args: ["-c", "import rasterio; print(f'GDAL {rasterio.__gdal_version__}')"]
    exitCode: 0
  - name: "All UN-Handbook R packages available"
    command: "Rscript"
    args: ["/opt/eostat/test-handbook-packages.R"]
    exitCode: 0
